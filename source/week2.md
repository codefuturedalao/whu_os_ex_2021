# week2

## å®éªŒå†…å®¹

1. è®¤çœŸé˜…è¯»ç« èŠ‚èµ„æ–™ï¼ŒæŒæ¡ä»€ä¹ˆæ˜¯ä¿æŠ¤æ¨¡å¼ï¼Œå¼„æ¸…å…³é”®æ•°æ®ç»“æ„ï¼šGDTã€descriptorã€selectorã€GDTRï¼Œ åŠå…¶ä¹‹é—´å…³ç³»ï¼Œé˜…è¯»pm.incæ–‡ä»¶ä¸­æ•°æ®ç»“æ„ä»¥åŠå«ä¹‰ï¼Œå†™å‡ºå¯¹å®Descriptorçš„åˆ†æ

2. è°ƒè¯•ä»£ç ï¼Œ/a/ æŒæ¡ä»å®æ¨¡å¼åˆ°ä¿æŠ¤æ¨¡å¼çš„åŸºæœ¬æ–¹æ³•ï¼Œç”»å‡ºä»£ç æµç¨‹å›¾ï¼Œå¦‚æœä»£ç /a/ä¸­ï¼Œç¬¬71è¡Œæœ‰dwordå‰ç¼€å’Œæ²¡æœ‰å‰ç¼€ï¼Œç¼–è¯‘å‡ºæ¥çš„ä»£ç æœ‰åŒºåˆ«ä¹ˆï¼Œä¸ºä»€ä¹ˆï¼Œè¯·è°ƒè¯•æˆªå›¾ã€‚

3. è°ƒè¯•ä»£ç ï¼Œ/b/ï¼ŒæŒæ¡GDTçš„æ„é€ ä¸åˆ‡æ¢ï¼Œä»ä¿æŠ¤æ¨¡å¼åˆ‡æ¢å›å®æ¨¡å¼æ–¹æ³•

4. è°ƒè¯•ä»£ç ï¼Œ/c/ï¼ŒæŒæ¡LDTåˆ‡æ¢

5. è°ƒè¯•ä»£ç ï¼Œ/d/æŒæ¡ä¸€è‡´ä»£ç æ®µã€éä¸€è‡´ä»£ç æ®µã€æ•°æ®æ®µçš„æƒé™è®¿é—®è§„åˆ™ï¼ŒæŒæ¡CPLã€DPLã€RPLä¹‹é—´å…³ç³»ï¼Œä»¥åŠæ®µé—´åˆ‡æ¢çš„åŸºæœ¬æ–¹æ³•

6. è°ƒè¯•ä»£ç ï¼Œ/e/æŒæ¡åˆ©ç”¨è°ƒç”¨é—¨è¿›è¡Œç‰¹æƒçº§å˜æ¢çš„è½¬ç§»çš„åŸºæœ¬æ–¹æ³•

## å®éªŒæ­¥éª¤

### é…ç½®ç¯å¢ƒ

1. è¿è¡Œå‘½ä»¤```dd if=pmtest1.bin of=a.img bs=512 count=1 conv=notrunc```å°†pmtest1.binå†™å…¥a.imgï¼Œç„¶åå¯åŠ¨bochsï¼ŒæŸ¥çœ‹ç»“æœï¼Œå¯ä»¥çœ‹åˆ°ç•Œé¢å³ä¾§å‡ºç°çº¢è‰²p

   ![image-20210917145432463](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917145432463.png)

2. ä¸‹è½½[freedos](http://bochs.sourceforge.net/guestos/freedos-img.tar.gz)ï¼Œå°†è§£å‹åçš„a.imgå‘½åä¸ºfreedos.imgï¼Œå¤åˆ¶åˆ°å·¥ä½œç›®å½•ä¸‹ï¼ˆlinuxä¸­å‘½ä»¤è¡Œé‡å‘½åå‘½ä»¤ä¸ºmvï¼‰

3. ç”¨bximageç”Ÿæˆä¸€ä¸ªè½¯ç›˜æ˜ åƒï¼Œèµ·åä¸ºpm.img

4. ä¿®æ”¹bochsrcï¼Œç¡®ä¿æœ‰ä»¥ä¸‹ä¸‰è¡Œã€‚æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ï¼Œè¿™ä¸‰è¡Œè¯´æ˜æˆ‘ä»¬æœ‰ä¸¤ä¸ªè½¯ç›˜ï¼Œåˆ†åˆ«æ˜¯freedos.imgå’Œpm.imgï¼Œæˆ‘ä»¬å°†ä»aç›˜ä¹Ÿå°±æ˜¯floppyaå¯åŠ¨ï¼Œfloppybä¼šè‡ªåŠ¨æˆä¸ºbç›˜ã€‚

   ![image-20210917145903441](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917145903441.png)

5. å¯åŠ¨bochsã€‚

   ![image-20210917150004023](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917150004023.png)

6. è¾“å…¥```format b:```æ ¼å¼åŒ–Bç›˜ï¼ŒBç›˜å…¶å®å°±æ˜¯æˆ‘ä»¬çš„pm.imgé•œåƒæ–‡ä»¶

   ![image-20210917150137783](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917150137783.png)

   æ ¼å¼åŒ–æ“ä½œç›¸å½“äºå°†å…¶è½¬åŒ–ä¸ºFAT32æ–‡ä»¶ç³»ç»Ÿï¼Œå½“æˆ‘ä»¬åˆ°terminalæŸ¥çœ‹pm.imgå†…å®¹æ—¶ï¼Œå¯ä»¥çœ‹åˆ°pm.imgä¸­å·²ç»å†™å…¥äº†ä¸€äº›æ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„ä¸œè¥¿ï¼Œä¸å†æ˜¯é‚£ä¸ªå…¨ä¸º0çš„å®ƒäº†ã€‚

   ![image-20210917150538255](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917150538255.png)

7. ä¿®æ”¹pmtest1.asmä»£ç ä¸­çš„```07c00h```ä¸º```0100h```

   ![image-20210917150659111](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917150659111.png)

8. è¾“å…¥å‘½ä»¤```nasm pmtest1.asm -o pmtest1.com```å°†pmtest1.asmç¼–è¯‘ä¸ºcomæ–‡ä»¶

9. æŒ‚è½½pm.imgï¼Œå¹¶å°†ç”Ÿæˆçš„pmtest.comæ‹·è´åˆ°è½¯ç›˜ä¸­

   ```
   sudo mkdir /mnt/floppy
   sudo mount -o loop pm.img /mnt/floppy
   sudo cp pmtest1.com /mnt/floppy/
   sudo umount /mnt/floppy
   ```

10. é‡æ–°å¯åŠ¨bochsï¼Œåœ¨freedosä¸­è¿è¡Œå‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°ç•Œé¢å³ä¾§å‡ºç°çº¢è‰²å­—æ¯p

    ![image-20210917151405604](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917151405604.png)

    ç”±äºpmtest1ä¸­çš„```jmp $```ï¼Œä½ ä¼šçœ‹åˆ°ç¨‹åºæœªå°†æ§åˆ¶æƒäº¤è¿˜ç»™freedosï¼Œä¸ç”¨æ‹…å¿ƒï¼Œåé¢ä½ ä¼šçœ‹åˆ°å¦‚ä½•å°†æ§åˆ¶æƒäº¤è¿˜ç»™freedosã€‚

### å‡çº§è£…å¤‡

ç°åœ¨ä¼‘æ¯ä¸€ä¸‹ï¼Œå¯ä»¥å–å£æ°´ä»€ä¹ˆçš„ã€‚

ä½ å¯èƒ½å‘ç°ç”±äºæˆ‘ä»¬ä¸çŸ¥é“freedosæŠŠç¨‹åºåŠ è½½åˆ°äº†å“ªé‡Œï¼Œæ‰€ä»¥åœ¨å“ªé‡Œæ‰“æ–­ç‚¹æ¥è¿›è¡Œè°ƒè¯•å¯¹äºæˆ‘ä»¬æ¥è¯´éå¸¸æ£˜æ‰‹ğŸ˜”ï¼Œè¿™é‡Œæ¨èæŸ¥çœ‹ä¸€ä¸‹FAQä¸­çš„how to debug in freedosã€‚

ç°åœ¨å‡è®¾ä½ å·²ç»å·²ç»çŸ¥é“äº†å¦‚ä½•è°ƒè¯•ï¼Œé‚£ä¹ˆæˆ‘ä»¬åé¢çš„ä»»åŠ¡æ— éå°±æ˜¯åœ¨æƒ³è¦æ‰“æ–­ç‚¹çš„ä½ç½®åŠ ä¸Š```xchg bx, bx```ï¼Œç„¶åå¯åŠ¨bochsè¿›è¡Œè°ƒè¯•å³å¯ã€‚

å®éªŒçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ”¹åŠ¨pmtestä¸­çš„ä»£ç ï¼Œç„¶åæ±‡ç¼–ã€æŒ‚è½½pm.imgã€æ‹·è´ã€å–æ¶ˆæŒ‚è½½ä»¥åŠå¯åŠ¨bochsï¼Œè¿™å‡ ä¸ªé‡å¤ä¸”æ¯ç‡¥çš„åŠ¨ä½œè®©äººå¿ƒç–²åŠ›ç«­ï¼Œäºæ˜¯è¿™é‡Œæä¾›ä¸€ä¸ªç®€å•çš„è„šæœ¬ï¼Œå¯èƒ½å¯ä»¥èŠ‚çœä¸€ä¸‹æˆ‘ä»¬çš„æ—¶é—´ã€‚ï¼ˆç›´æ¥ä½¿ç”¨makefileä¹Ÿå¯ä»¥å®ç°åŒæ ·çš„æ•ˆæœï¼‰

```shell
#!/bin/sh

# Author : jackson sang
# toy script

sudo mount pm.img -o loop /mnt/floppy
for f in *.asm;
do
	nasm "${f}" -o "${f%.asm}.com"
	if [ $? -ne 0 ]; 
	then
		sudo umount /mnt/floppy
    		echo "Failed to assemble!!!"
    		exit 1
	fi
	sudo cp  "${f%.asm}.com" /mnt/floppy
	rm "${f%.asm}.com"
done

sudo umount /mnt/floppy
bochs
```

ä¸Šé¢ä»£ç çš„ä½œç”¨å°±æ˜¯å°†å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰çš„æ±‡ç¼–æ–‡ä»¶ç¼–è¯‘ä¸ºcomæ–‡ä»¶ï¼Œç„¶åå†™å…¥pm.imgï¼Œæœ€åå¯åŠ¨bochsã€‚

å¦‚æœä½ æ„¿æ„ä½¿ç”¨çš„è¯ï¼Œè¯·æ–°å»ºä¸€ä¸ªbuild.shæ–‡ä»¶ï¼Œå°†ä¸Šé¢ä»£ç æ‹·è´è¿›å»ï¼Œç„¶åä½¿ç”¨```sudo chmod +x build.sh```å‘½ä»¤ä½¿build.shå¯æ‰§è¡Œï¼Œä¹‹åæ¯æ¬¡ä¿®æ”¹å®Œæ±‡ç¼–æ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤```./build.sh```å³å¯å¯åŠ¨bochsäº†ã€‚

### è¯¾åå®éªŒ

```{admonition} æç¤º
è¯¾åå®éªŒæ€è·¯ä»…ä¾›å‚è€ƒï¼Œæ•…å°½å¯èƒ½å‡å°‘ç¤ºä¾‹å›¾ç‰‡çš„å‡ºç°å’Œæ–‡å­—æè¿°ã€‚
```

#### è¯¾ååŠ¨æ‰‹æ”¹1

1. ç¼–å†™GDTä»£ç æ®µï¼Œå†™å…¥å†…å­˜å†…å®¹

   ![image-20210917200414001](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917200414001.png)

2. ç¼–å†™LDTä»£ç æ®µï¼Œè¯»å–GDTå†…å®¹å¹¶æ‰“å°

   ![image-20210917200457485](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917200457485.png)

3. å¢åŠ GDTä»£ç æ®µæè¿°ç¬¦ï¼Œä»¥åŠè®¾ç½®é€‰æ‹©ç¬¦

4. å¢åŠ LDTä»£ç æ®µæè¿°ç¬¦ï¼Œä»¥åŠè®¾ç½®é€‰æ‹©ç¬¦

5. åœ¨å®æ¨¡å¼ä»£ç ä¸­åˆå§‹åŒ–æ–°å¢æ®µçš„æè¿°ç¬¦

   ![image-20210917200601733](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917200601733.png)

   ![image-20210917200610459](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917200610459.png)

6. ç¼–è¯‘æ‰§è¡Œï¼ˆè¯·æ³¨æ„ä¿®æ”¹ç›¸åº”ä½ç½®æ¥ç¡®ä¿ä½ çš„ä»£ç ä¼šè·³è½¬åˆ°æ–°å¢çš„ä¸¤ä¸ªä»£ç æ®µæ‰§è¡Œï¼‰

   ![image-20210917200728687](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917200728687.png)

#### è¯¾ååŠ¨æ‰‹æ”¹2

å®éªŒä»£ç å·²ç»æä¾›äº†é«˜ç‰¹æƒçº§é€šè¿‡retfè·³åˆ°ä½ç‰¹æƒçº§ï¼Œä½ç‰¹æƒçº§é€šè¿‡è°ƒç”¨é—¨è·³å›é«˜ç‰¹æƒçº§çš„ä»£ç ï¼Œäºæ˜¯æˆ‘ä»¬é‡‡ç”¨å¦ä¸€ç§æ–¹æ³•ï¼Œé€šè¿‡è®¾ç½®é«˜ç‰¹æƒçº§ä»£ç æ®µä¸ºä¸€è‡´æ€§ä»£ç æ®µï¼Œä»è€Œå®ç°ä½ç‰¹æƒçº§åˆ°é«˜ç‰¹æƒçº§çš„è·³è½¬ã€‚ï¼ˆå“ªç§æ–¹å¼éƒ½æ˜¯å¯ä»¥çš„ï¼Œåªè¦å®ç°ä¸åŒç‰¹æƒçº§ä»£ç æ®µè·³è½¬å³å¯ï¼‰

1. å®šä¹‰dpl=3çš„æ•°æ®æ®µå¹¶å®šä¹‰æ®µæè¿°ç¬¦å’Œæ®µé€‰æ‹©ç¬¦ï¼ŒåŒæ—¶åˆå§‹åŒ–æ®µæè¿°ç¬¦ã€‚

   ![image-20210924111925899](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210924111925899.png)

2. å®šä¹‰ring3ä»£ç æ®µæè¿°ç¬¦å’Œæ®µé€‰æ‹©ç¬¦ï¼ŒåŒæ—¶åˆå§‹åŒ–æ®µæè¿°ç¬¦

3. ç¼–å†™ring3ä»£ç æ®µï¼Œå®ç°è¾“å‡ºå­—ç¬¦ä¸²ï¼Œå¹¶é€šè¿‡callæŒ‡ä»¤è·³è½¬åˆ°ring0ä»£ç æ®µ

   ![image-20210924110712138](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210924110712138.png)

4. å®šä¹‰ring0ä»£ç æ®µæè¿°ç¬¦å’Œé€‰æ‹©ç¬¦ï¼ŒåŒæ—¶åˆå§‹åŒ–æ®µæè¿°ç¬¦

   éœ€è¦åœ¨ä»£ç æ®µä¸­è®¾ç½®DA_CCOå±æ€§ï¼Œè¡¨ç¤ºä¸ºä¸€è‡´æ€§ä»£ç æ®µã€‚

   ![image-20210924111411154](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210924111411154.png)

5. ç¼–å†™ring0ä»£ç æ®µï¼Œå®ç°è¾“å‡ºå­—ç¬¦ä¸²

   è¯·æ³¨æ„ï¼Œç”±äºä»ring3è·³è½¬åˆ°ring0ä¸€è‡´æ€§ä»£ç æ®µä¸æ›´æ”¹cplï¼Œå› æ­¤æ­¤æ—¶ä»£ç æ®µç›¸å½“äºè¿è¡Œåœ¨ç‰¹æƒçº§3ä¸‹ï¼Œå‘dsåŠ è½½æ•°æ®æ®µé€‰æ‹©ç¬¦æ—¶ï¼ŒåŠ è½½äº†æŒ‡å‘dpl=3çš„æ•°æ®æ®µé€‰æ‹©ç¬¦ã€‚åŒæ—¶ç”±äºç‰¹æƒçº§çš„é—®é¢˜ï¼Œä¹Ÿä¸èƒ½ç›´æ¥ä»æ”¹ä»£ç æ®µé€šè¿‡```jmp SelectorCode16:0```è·³åˆ°16ä½ä»£ç æ®µï¼Œéœ€è¦é€šè¿‡retfè¿”å›åˆ°ring3ï¼Œä¹‹åé€šè¿‡ç»™å‡ºçš„è°ƒç”¨é—¨è¿›è¡Œè¿”å›ã€‚

   ![image-20210924112709677](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210924112709677.png)

6. å®éªŒæ•ˆæœ

   ![image-20210924112003595](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210924112003595.png)

## å®éªŒç»ƒä¹ 

1. GDTã€Descriptorã€Selectorã€GDTRç»“æ„ï¼ŒåŠå…¶å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿä»–ä»¬çš„å…³è”å…³ç³»å¦‚ä½•ï¼Ÿpm.incæ‰€å®šä¹‰çš„å®æ€ä¹ˆä½¿ç”¨ï¼Ÿ

2. ä»å®æ¨¡å¼åˆ°ä¿æŠ¤æ¨¡å¼ï¼Œå…³é”®æ­¥éª¤æœ‰å“ªäº›ï¼Ÿä¸ºä»€ä¹ˆè¦å…³ä¸­æ–­ï¼Ÿä¸ºä»€ä¹ˆè¦æ‰“å¼€A20åœ°å€çº¿ï¼Ÿä»ä¿æŠ¤æ¨¡å¼åˆ‡æ¢å›å®æ¨¡å¼ï¼Œåˆéœ€è¦å“ªäº›æ­¥éª¤ï¼Ÿ

3. è§£é‡Šä¸åŒæƒé™ä»£ç çš„åˆ‡æ¢åŸç†ï¼Œcall, jmpï¼Œretfä½¿ç”¨åœºæ™¯å¦‚ä½•ï¼Œèƒ½å¤Ÿäº’æ¢å—ï¼Ÿ

4. è¯¾ååŠ¨æ‰‹æ”¹ï¼š

	1. è‡ªå®šä¹‰æ·»åŠ 1ä¸ªGDTä»£ç æ®µã€1ä¸ªLDTä»£ç æ®µï¼ŒGDTæ®µå†…è¦å¯¹ä¸€ä¸ªå†…å­˜æ•°æ®ç»“æ„å†™å…¥ä¸€æ®µå­—ç¬¦ä¸²ï¼Œç„¶åLDTæ®µå†…ä»£ç æ®µåŠŸèƒ½ä¸ºè¯»å–å¹¶æ‰“å°è¯¥GDTçš„å†…å®¹ï¼›
	2. è‡ªå®šä¹‰2ä¸ªGDTä»£ç æ®µAã€Bï¼Œåˆ†å±äºä¸åŒç‰¹æƒçº§ï¼ŒåŠŸèƒ½è‡ªå®šä¹‰ï¼Œè¦æ±‚å®ç°A-->Bçš„è·³è½¬ï¼Œä»¥åŠB-->Açš„è·³è½¬ã€‚


## FAQ
### Q: No Boot Device

è¿™ç§æƒ…å†µå¤§æ¦‚ç‡æ˜¯å› ä¸ºåœ¨åšchapter3/aæ—¶ä»¥a.imgä¸ºå¯åŠ¨ç›˜ï¼Œä½†æ˜¯a.imgç»“å°¾å¹¶æ²¡æœ‰55aaæ ‡å¿—ï¼ˆå¯ä½¿ç”¨hexdumpå‘½ä»¤æŸ¥çœ‹ï¼‰ï¼Œè¯·æ‹·è´chapter1/a/ç›®å½•ä¸‹çš„a.imgï¼ˆç¡®ä¿å…·æœ‰55aaæ ‡å¿—ï¼‰ï¼Œç„¶åé‡æ–°å°†pmtest1.biné‡æ–°å†™å…¥a.imgï¼Œä¹‹åå†æ¬¡å¯åŠ¨bochsã€‚

### Q: wrong fs type, bad option, bad superblock on

è¯·å…ˆå°†åœ¨freedosä¸­å°†pm.imgè¿›è¡Œæ ¼å¼åŒ–ï¼Œmountå‘½ä»¤æ— æ³•ç›´æ¥è¯†åˆ«ä¸€ä¸ªimgæ–‡ä»¶ï¼Œéœ€è¦æŒ‚è½½å¯è¯†åˆ«çš„æ–‡ä»¶ç³»ç»Ÿã€‚

### Q: format b: error

å…·ä½“åŸå› å¤šç§å¤šæ ·ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

1. ç¡®ä¿bochsrcä¸­æ·»åŠ è¦æ±‚çš„ä¸‰è¡Œå†…å®¹ï¼Œ**å¹¶åˆ å»äº†ä¹‹å‰çš„floppya : xxxx**ã€‚
2. ç¡®ä¿bximageæ–°å»ºäº†pm.img
3. ç¡®ä¿pm.imgæœ‰å†™å…¥æƒé™
4. ç¡®ä¿pm.imgçš„ownerå’Œgroupæ˜¯å½“å‰ç”¨æˆ·è€Œérootï¼Œå¦åˆ™ç”¨chownå’Œchgrpå‘½ä»¤è¿›è¡Œä¿®æ”¹ã€‚

### Q: how to debug in freedos

1. debug

   æœ¬æŒ‡å¯¼æä¾›çš„freedos-img.tar.gzä¸­c.imgä¸­è£…äº†debugç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨debugæ¥è°ƒè¯•ç¨‹åºã€‚ä¿®æ”¹é…ç½®æ–‡ä»¶å¦‚ä¸‹

   ![image-20210917162205973](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917162205973.png)

   è¿è¡Œbochsï¼Œå¯ä»¥å‘ç°cç›˜çš„BINç›®å½•ä¸‹æœ‰debugç¨‹åºï¼Œè¾“å…¥å‘½ä»¤```path c:\bin```ï¼Œè¿›å…¥bç›˜ï¼Œè¾“å…¥å‘½ä»¤```debug pmtest1.com```ä¾¿å¯ä»¥è¿›è¡Œè°ƒè¯•ã€‚

2. åŠ æ­»å¾ªç¯

   åœ¨ç¨‹åºå¼€å¤´åŠ ä¸Š```jmp $```ä»¤ç¨‹åºæ­»å¾ªç¯ï¼Œæ‰§è¡Œç¨‹åºåï¼Œåœ¨bochsè°ƒè¯•çª—å£æŒ‰ctrl-cï¼Œä¹‹åä¿®æ”¹eipå¯„å­˜å™¨çš„å€¼æŒ‡å‘ç¨‹åºå…¥å£ã€‚

3. magic numberï¼ˆæ¨èï¼‰

   åœ¨bochsrcä¸­æ·»åŠ ```magic_break: enabled=1```

   ![image-20210917162323976](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917162323976.png)

   åœ¨ç¨‹åºå¼€å¤´æ·»åŠ å‘½ä»¤```xchg bx,bx```

   é‡æ–°ç¼–è¯‘è¿è¡Œï¼Œå¯ä»¥å‘ç°å½“è¿è¡Œç¨‹åºæ—¶bochsä¼šåœ¨ç¨‹åºå¼€å¤´åœæ­¢ï¼Œç°åœ¨å¯ä»¥è¿›è¡Œè°ƒè¯•äº†ã€‚

   ![image-20210917162706733](https://sql-markdown-picture.oss-cn-beijing.aliyuncs.com/img/image-20210917162706733.png)

   ```xchg bx, bx```çš„æœºå™¨ç ä¸º```87 DB```ï¼Œä¸çŸ¥å‡ºäºä»€ä¹ˆåŸå› bochsrcé‡åˆ°87 DBä¼šåœæ­¢è¿è¡Œï¼Œå› æ­¤ä½ å¯ä»¥å°†xchgæ’å…¥åˆ°ä»»ä½•ä½ æƒ³è¦è°ƒè¯•çš„åœ°æ–¹ï¼Œè¾¾åˆ°æ–­ç‚¹çš„æ•ˆæœã€‚

### Q: bochsä¸­é”®ç›˜ä¸å“åº”

   ç­‰å¾…æˆ–é‡æ–°å¯åŠ¨bochsã€‚
